apiVersion: "1"

removeStrategy:
  items: NONE
  rbac: SYNC

items:
  - kind: managedController
    name: mc-blue
    displayName: Blue Managed Controller
    description: Blue environment managed controller

    groups:
      - name: Blue Developers
        members:
          users:
            - bluedev
            - blueadmin
        roles:
          - name: developer

    properties:
      - configurationAsCode:
          bundle: mc-blue
      - healthReporting:
          enabled: true
      - envelopeExtension:
          allowExceptions: false
      - sharedConfigurationOptOut:
          optOut: false
      - licensing:
          strategy:
            perUserLicensingStrategy: {}

    configuration:
      kubernetes:
        clusterEndpointId: default
        domain: blue
        allowExternalAgents: false
        fsGroup: "1000"

        replication:
          config:
            replicas: 3
            maxReplicas: 5
            targetCPUUtilizationPercentage: 80

        memory: 3072
        cpus: 1.0
        disk: 50

        terminationGracePeriodSeconds: 1200
        readinessInitialDelaySeconds: 30
        readinessTimeoutSeconds: 5
        readinessFailureThreshold: 100
        livenessInitialDelaySeconds: 300
        livenessPeriodSeconds: 10
        livenessTimeoutSeconds: 10

        javaOptions: >
          -Denv=blue
          -Dcontroller.color=blue

        yaml: |-
          apiVersion: apps/v1
          kind: StatefulSet
          metadata:
            labels:
              environment: blue
              controller: mc-blue

